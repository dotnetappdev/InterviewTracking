<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:vm="clr-namespace:InterviewTracking.Maui.ViewModels"
             x:Class="InterviewTracking.Maui.Views.CompaniesAZPage"
             x:DataType="vm:InterviewListViewModel"
             Title="Companies A-Z">
    
    <Grid RowDefinitions="Auto,*" Padding="10">
        <Label Grid.Row="0" 
               Text="Companies Alphabetically" 
               FontSize="20" 
               FontAttributes="Bold" 
               Margin="0,0,0,10"/>
        
        <CollectionView Grid.Row="1" 
                       ItemsSource="{Binding CompaniesGroupedAZ}"
                       IsGrouped="True">
            
            <CollectionView.GroupHeaderTemplate>
                <DataTemplate x:DataType="vm:CompanyGroup">
                    <Label Text="{Binding Letter}"
                           FontSize="24"
                           FontAttributes="Bold"
                           BackgroundColor="{AppThemeBinding Light=#E0E0E0, Dark=#3C3C3C}"
                           Padding="10,5"
                           Margin="0,10,0,5"/>
                </DataTemplate>
            </CollectionView.GroupHeaderTemplate>
            
            <CollectionView.ItemTemplate>
                <DataTemplate x:DataType="vm:CompanyItem">
                    <Frame Margin="5" Padding="10" BorderColor="Gray" CornerRadius="8" HasShadow="False">
                        <Frame.GestureRecognizers>
                            <TapGestureRecognizer Command="{Binding Source={RelativeSource AncestorType={x:Type vm:InterviewListViewModel}}, Path=FilterByCompanyCommand}"
                                                CommandParameter="{Binding CompanyName}"/>
                        </Frame.GestureRecognizers>
                        
                        <Grid ColumnDefinitions="*,Auto">
                            <VerticalStackLayout Grid.Column="0">
                                <Label Text="{Binding CompanyName}"
                                       FontSize="16"
                                       FontAttributes="Bold"/>
                                <Label Text="{Binding InterviewCount, StringFormat='{0} interview(s)'}"
                                       FontSize="12"
                                       TextColor="Gray"/>
                            </VerticalStackLayout>
                            
                            <Label Grid.Column="1" 
                                   Text="â€º"
                                   FontSize="24"
                                   VerticalOptions="Center"
                                   TextColor="Gray"/>
                        </Grid>
                    </Frame>
                </DataTemplate>
            </CollectionView.ItemTemplate>
            
            <CollectionView.EmptyView>
                <VerticalStackLayout VerticalOptions="Center" HorizontalOptions="Center" Padding="20">
                    <Label Text="No companies found"
                           FontSize="18"
                           HorizontalOptions="Center"/>
                    <Label Text="Add interviews to see companies here"
                           HorizontalOptions="Center"
                           Margin="0,10,0,0"/>
                </VerticalStackLayout>
            </CollectionView.EmptyView>
        </CollectionView>
    </Grid>
</ContentPage>
